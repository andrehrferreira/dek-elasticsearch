{"version":3,"sources":["../src/index.js"],"names":["Client6","Client7","env","process","hosts","ELASTICSEARCH_HOST","indexOf","split","Set","client","ELASTICSEARCH_VERSION","Array","isArray","Client","nodes","node","Elasticsearch","DEBUG","console","log","$","set","e","message"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;IAAYA,O;;AACZ;;IAAYC,O;;;;;;;;kBAEG,YAAM;AACjB,QAAG;AACC,YAAIC,MAAMC,QAAQD,GAAlB;AACA,YAAIE,QAASF,IAAIG,kBAAJ,CAAuBC,OAAvB,CAA+B,GAA/B,IAAsC,CAAC,CAAxC,GAA6CJ,IAAIG,kBAAJ,CAAuBE,KAAvB,CAA6B,GAA7B,CAA7C,GAAiFL,IAAIG,kBAAjG;AACAD,6CAAY,IAAII,GAAJ,CAAQJ,KAAR,CAAZ,GAHD,CAG6B;;AAE5B,YAAIK,SAAS,IAAb;;AAEA,gBAAOP,IAAIQ,qBAAX;AACI,iBAAK,GAAL;AACI,oBAAGC,MAAMC,OAAN,CAAcR,KAAd,CAAH,EACIK,SAAS,IAAIT,QAAQa,MAAZ,CAAoB,EAAEC,OAAOV,KAAT,EAApB,CAAT,CADJ,KAGIK,SAAS,IAAIT,QAAQa,MAAZ,CAAoB,EAAEE,MAAMX,KAAR,EAApB,CAAT;AACR;AACA,iBAAK,GAAL;AACI,oBAAGO,MAAMC,OAAN,CAAcR,KAAd,CAAH,EACIK,SAAS,IAAIR,QAAQY,MAAZ,CAAoB,EAAEC,OAAOV,KAAT,EAApB,CAAT,CADJ,KAGIK,SAAS,IAAIR,QAAQY,MAAZ,CAAoB,EAAEE,MAAMX,KAAR,EAApB,CAAT;AACR;AACA;AAASK,yBAAS,IAAIO,wBAAcH,MAAlB,CAA0B,EAAET,OAAOA,KAAT,EAA1B,CAAT,CAAuD;AAbpE;;AAgBA,YAAGD,QAAQD,GAAR,CAAYe,KAAZ,IAAqB,MAAxB,EACIC,QAAQC,GAAR;;AAEJC,iBAAEC,GAAF,CAAM,eAAN,EAAuBZ,MAAvB;AACH,KA3BD,CA4BA,OAAOa,CAAP,EAAU;AACNJ,gBAAQC,GAAR,0BAAmCG,EAAEC,OAArC,EAAgDD,CAAhD;AACH;AACJ,C","file":"index.js","sourcesContent":["import { $ } from \"@dekproject/scope\";\nimport Elasticsearch from 'elasticsearch';\nimport * as Client6 from 'es6';\nimport * as Client7 from 'es7';\n\nexport default () => {\n    try{\n        let env = process.env;\n        let hosts = (env.ELASTICSEARCH_HOST.indexOf(\",\") > -1) ? env.ELASTICSEARCH_HOST.split(\",\") : env.ELASTICSEARCH_HOST;\n        hosts = [...new Set(hosts)];//Fix duplicate hosts (@farchanjo)\n\n        let client = null;\n\n        switch(env.ELASTICSEARCH_VERSION){\n            case \"6\": \n                if(Array.isArray(hosts))\n                    client = new Client6.Client( { nodes: hosts }); \n                else\n                    client = new Client6.Client( { node: hosts });\n            break;\n            case \"7\": \n                if(Array.isArray(hosts))\n                    client = new Client7.Client( { nodes: hosts });\n                else\n                    client = new Client7.Client( { node: hosts }); \n            break;\n            default: client = new Elasticsearch.Client( { hosts: hosts } ); break;\n        }\n\n        if(process.env.DEBUG == 'true')\n            console.log(`[ Elasticsearch ] - Elasticsearch successfully signed`);\n\n        $.set(\"elasticsearch\", client);\n    }\n    catch (e) {\n        console.log(`[ Elasticsearch ] - ${e.message}`, e);\n    }\n}\n"]}